---
import { db, Confess } from "astro:db";
const confessions = await db.select().from(Confess).limit(10);
---

<div class="overflow-hidden w-full max-w-screen-xl mx-auto py-6 px-4">
  <div class="relative h-[76px] overflow-hidden group">
    <div class="absolute whitespace-nowrap flex animate-[marquee_60s_linear_infinite] hover:pause">
      {confessions.map(({ name, to }) => (
        <div class="flex-shrink-0 w-[340px] h-full px-2">
          <div class="h-full bg-white/10 backdrop-blur-sm rounded-xl border border-indigo-500/20 flex items-center p-4 transition-all duration-300 hover:bg-white/15 hover:shadow-lg hover:border-indigo-400/50">
            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold shadow-sm">
              {(name || "A")[0].toUpperCase()}
            </div>
            <div class="ml-3 flex-1">
              <p class="text-sm text-white flex flex-wrap items-center gap-x-1">
                <span class="font-semibold text-white/95">{name || "Anonymous"}</span>
                <span class="text-indigo-300/80 text-xs">sent to</span>
                <span class="font-semibold text-indigo-400">{to}</span>
              </p>
            </div>
          </div>
        </div>
      ))}
      {/* Duplicate for seamless looping */}
      {confessions.map(({ name, to }) => (
        <div class="flex-shrink-0 w-[340px] h-full px-2">
          <div class="h-full bg-white/10 backdrop-blur-sm rounded-xl border border-indigo-500/20 flex items-center p-4 transition-all duration-300 hover:bg-white/15 hover:shadow-lg hover:border-indigo-400/50">
            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold shadow-sm">
              {(name || "A")[0].toUpperCase()}
            </div>
            <div class="ml-3 flex-1">
              <p class="text-sm text-white flex flex-wrap items-center gap-x-1">
                <span class="font-semibold text-white/95">{name || "Anonymous"}</span>
                <span class="text-indigo-300/80 text-xs">sent to</span>
                <span class="font-semibold text-indigo-400">{to}</span>
              </p>
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</div>

<style>
  @keyframes marquee {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  
  .hover\:pause:hover {
    animation-play-state: paused;
  }

    .group {
    mask-image: linear-gradient(
      to right,
      transparent,
      white 10%,
      white 90%,
      transparent
    );
  }
</style>